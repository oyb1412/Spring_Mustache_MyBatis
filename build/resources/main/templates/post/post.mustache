{{> other/header}}

<main class="container mx-auto px-4 pt-24 pb-12">
  <div class="flex flex-col md:flex-row gap-8">
    <input type="hidden" id="post-id" value="{{post.id}}">
    <input type="hidden" id="board-id" value="{{board.id}}">
    <!-- ì™¼ìª½ ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <div class="w-full md:w-3/4">

      <!-- ê²Œì‹œê¸€ ì¹´ë“œ -->
      <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-100">

        <!-- ê²Œì‹œíŒ ì´ë¦„ -->
        <h2 class="text-xl font-bold text-primary mb-4">{{board.name}}</h2>

        <!-- ê²Œì‹œê¸€ ì œëª© -->
        <h1 class="text-2xl font-semibold text-gray-800 mb-2">{{post.title}}</h1>

        <!-- ì‘ì„±ì ì •ë³´ -->
  <div class="mb-6 flex items-center justify-between text-sm text-gray-500">
  <div class="flex items-center gap-3">
    <!-- í”„ë¡œí•„ ì´ë¯¸ì§€ -->
    <img 
      src="{{#post.authorProfileImage}}data:image/png;base64,{{post.authorProfileImage}}{{/post.authorProfileImage}}{{^post.authorProfileImage}}/images/default-profile.png{{/post.authorProfileImage}}" 
      alt="ì‘ì„±ì í”„ë¡œí•„ ì´ë¯¸ì§€" 
      class="w-8 h-8 rounded-full object-cover border"
    />
    <span>ì‘ì„±ì: <span class="font-medium text-gray-700">{{post.author}}</span></span>
    <span>ë ˆë²¨: <span class="font-medium text-gray-700">{{post.userLevel}}</span></span>
  </div>
  </div>

        <!-- ì‘ì„±ì¼ + ì¡°íšŒìˆ˜ + ëŒ“ê¸€ìˆ˜ -->
        <div class="text-sm text-gray-500 mb-6">
          ì‘ì„±ì¼: {{post.createdDate}} |
          ì¡°íšŒìˆ˜: {{post.viewCount}} |
          ëŒ“ê¸€: {{post.commentCount}}ê°œ
        </div>

        <!-- ê²Œì‹œê¸€ ë‚´ìš© -->
        <div class="prose max-w-none text-gray-700 whitespace-pre-line leading-relaxed mb-6 min-h-[200px]">
             {{{post.content}}}
        </div>

        <!-- ì²¨ë¶€íŒŒì¼ í‘œì‹œ -->
        {{#post.fileName}}
        <div class="border-t pt-4 mt-6 mb-4 text-sm text-gray-700">
          ğŸ“ ì²¨ë¶€íŒŒì¼:
          <a href="{{post.filePath}}" download class="text-blue-500 hover:underline ml-2">
            {{post.fileName}}
          </a>
        </div>
        {{/post.fileName}}

        <!-- ì¢‹ì•„ìš”/ì‹«ì–´ìš” ë²„íŠ¼ -->
        <div class="flex items-center gap-3 mb-6">
          <button class="rounded-full bg-gray-100 hover:bg-gray-200 px-4 py-2 text-sm" id="btn-like">ğŸ‘</button>
          <span class="text-gray-800 font-medium text-sm">{{post.likeCount}}</span>
          <button class="rounded-full bg-gray-100 hover:bg-gray-200 px-4 py-2 text-sm" id="btn-dislike">ğŸ‘</button>
        </div>

        <!-- ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ (ì‘ì„±ìì¼ ê²½ìš°ì—ë§Œ) -->
        {{#isAuthor}}
        <div class="flex gap-2 mb-6">
          <a href="/postEdit-page/{{post.id}}" class="px-4 py-2 text-sm bg-blue-500 text-white rounded hover:bg-blue-600">ìˆ˜ì •</a>
          <button type="button" id="btn-post-delete" class="px-4 py-2 text-sm bg-red-500 text-white rounded hover:bg-red-600">ì‚­ì œ</button>
        </div>
        {{/isAuthor}}

        <!-- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ -->
        <div class="mt-4">
          <a href="javascript:history.back()" class="text-sm text-gray-600 hover:underline">â† ë’¤ë¡œê°€ê¸°</a>
        </div>
      </div>

      <!-- ëŒ“ê¸€ ì„¹ì…˜ -->
      <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-100 mt-8">
        <h3 class="text-lg font-bold text-gray-800 mb-4">ëŒ“ê¸€</h3>

       <!-- ëŒ“ê¸€ ëª©ë¡ -->
<div class="space-y-4 mb-6">
  {{#post.commentsDto}}
    {{^parentCommentDto}}
    <!-- ì¼ë°˜ ëŒ“ê¸€ -->
    <div class="border rounded px-4 py-3 text-sm text-gray-700 bg-gray-50 relative">
      <!-- ì‘ì„±ì -->
      <div class="mb-1 font-semibold text-gray-800">
        {{author}}
        <span class="ml-2 text-xs text-gray-400 font-normal align-middle">{{createdDate}}</span>
      </div>

      <!-- ëŒ“ê¸€ ë‚´ìš© -->
      <div>{{content}}</div>

      <!-- ìš°ì¸¡ ìƒë‹¨ ë²„íŠ¼ -->
      <div class="absolute top-2 right-3 space-x-2">
        <button class="btn-comment-reply text-blue-500 hover:underline text-xs" data-id="{{id}}">ë‹µê¸€</button>
        <button class="btn-comment-delete text-red-500 hover:underline text-xs" data-id="{{id}}">ì‚­ì œ</button>
      </div>
    </div>

      <!-- ìì‹ ëŒ“ê¸€ (ë‹µê¸€) -->
      {{#childCommentsDto}}
      <div class="border rounded px-4 py-3 text-sm text-gray-700 bg-white relative ml-6">
        <div class="mb-1 font-semibold text-gray-800">
          <span class="text-gray-400 mr-1">â†³</span>{{post.author}}
          <span class="ml-2 text-xs text-gray-400 font-normal align-middle">{{createdDate}}</span>
        </div>
        <div>{{content}}</div>
        <div class="absolute top-2 right-3">
          <button class="btn-comment-delete text-red-500 hover:underline text-xs" data-id="{{id}}">ì‚­ì œ</button>
        </div>
      </div>
      {{/childCommentsDto}}

    {{/parentCommentDto}}
  {{/post.commentsDto}}

  {{^post.commentsDto}}
  <div class="text-sm text-gray-400">ì•„ì§ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div>
  {{/post.commentsDto}}
</div>

<!-- ëŒ“ê¸€ ì‘ì„± í¼ -->
<div class="mt-6">
  <div class="flex items-center mb-2">
    <h5 class="text-sm font-semibold text-gray-800">ëŒ“ê¸€ ì‘ì„±</h5>
    <span id="reply-mode-text" class="text-sm text-blue-500 ml-2" style="display: none;">- ë‹µê¸€ ì‘ì„± ì¤‘</span>
  </div>
  <textarea id="comment-content" class="w-full border rounded px-4 py-2 text-sm" rows="3" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
  <div class="flex justify-end mt-2">
    <button type="button" id="btn-comment-register" class="bg-primary text-white text-sm px-4 py-2 rounded hover:bg-primary-dark">ëŒ“ê¸€ ì‘ì„±</button>
  </div>
</div>
      </div>

    </div>

    <!-- ì˜¤ë¥¸ìª½ ì‚¬ì´ë“œë°” -->
    {{> other/sidebar}}

  </div>
</main>

{{> other/footer}}
<script src="/js/post.js"></script>
